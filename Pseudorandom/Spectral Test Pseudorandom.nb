(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32446,        790]
NotebookOptionsPosition[     30941,        761]
NotebookOutlinePosition[     31278,        776]
CellTagsIndexPosition[     31235,        773]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Given", " ", "a", " ", "LCG", " ", 
     RowBox[{"(", 
      RowBox[{"a", ",", "m"}], ")"}]}], " ", "\[IndentingNewLine]", "-", 
    RowBox[{
    "we", " ", "compute", " ", "the", " ", "quality", " ", "of", " ", "the", 
     " ", "associated", " ", "pseudorandom", " ", "generator", " ", "in", " ",
      "terms", " ", "of", " ", "the", " ", "spectral", " ", "test"}], 
    "\[IndentingNewLine]", "-", 
    RowBox[{"EXAMPLES", " ", "end", " ", "of", " ", "the", " ", "code"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"N", "=", 
     RowBox[{"2", ":", " ", 
      RowBox[{"Given", " ", "a"}]}]}], ",", 
    RowBox[{
     RowBox[{
     "m", "  ", "we", " ", "compute", " ", "the", " ", "associated", " ", 
      "2"}], "-", 
     RowBox[{"dimensional", " ", "lattice"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Lattice2", "[", 
     RowBox[{"a_", ",", "m_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "V", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "2"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "m"}], ")"}], "*", 
           RowBox[{"a", "^", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "2"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Transpose", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       "V"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Compute", " ", "the", " ", "dual", " ", "lattice"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DualV2", "[", 
     RowBox[{"a_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "V", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Lattice2", "[", 
          RowBox[{"a", ",", "m"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Inverse", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       "V"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShortvectorGauss", "[", 
     RowBox[{"a_", ",", "m_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        RowBox[{"DualV2", "[", 
         RowBox[{"a", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "We", " ", "consider", " ", "the", " ", "transpose", " ", "because", 
          " ", 
          RowBox[{"V", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "selects", " ", "the", " ", 
          "i"}], "-", 
         RowBox[{
         "th", " ", "row", " ", "instead", " ", "of", " ", "column"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Transpose", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Apply", " ", "Gauss", " ", "algorithm", " ", "to", " ", "reduce", 
         " ", "the", " ", "lattice", " ", "basis"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Gaussalgorithm", "[", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"V", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Output", " ", "first", " ", "vector", " ", "reduced", " ", 
         "lattice"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"V", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"N", ">", "2"}], ":", " ", 
      RowBox[{"Given", " ", "a"}]}], ",", 
     RowBox[{
      RowBox[{
      "m", " ", "and", " ", "n", " ", "we", " ", "compute", " ", "the", " ", 
       "associated", " ", "n"}], "-", 
      RowBox[{"dimensional", " ", "lattice"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Lattice", "[", 
     RowBox[{"a_", ",", "m_", ",", "n_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "V", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "m"}], ")"}], "*", 
           RowBox[{"a", "^", 
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}]}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "2"}], ",", 
         RowBox[{"i", "\[LessEqual]", " ", "n"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Transpose", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       "V"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Compute", " ", "the", " ", "dual", " ", "lattice"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DualV", "[", 
     RowBox[{"a_", ",", "m_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "V", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Lattice", "[", 
          RowBox[{"a", ",", "m", ",", "n"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Inverse", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       "V"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"N", ">", 
     RowBox[{
      RowBox[{"2", " ", "approx", " ", "SVP", " ", "using", " ", "LLL"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "-", 
      RowBox[{"Technicality", ":", " ", 
       RowBox[{"In", " ", "mathematica", " ", 
        RowBox[{"V", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "extracts", " ", "rows", " ", 
        "so", " ", "it", " ", "is", " ", "more", " ", "convenient", " ", "to",
         " ", "work", " ", "with", " ", "the", " ", "transpose", " ", "of", 
        " ", "the", " ", "matrix", " ", "V"}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShortvectorLLL", "[", 
     RowBox[{"a_", ",", "m_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"V", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"V", "=", 
        RowBox[{"DualV", "[", 
         RowBox[{"a", ",", "m", ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"See", " ", "above"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"Transpose", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Reduce", " ", "lattice"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", 
        RowBox[{"LLLalgorithm", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "first", " ", "row", " ", 
         RowBox[{"(", 
          RowBox[{"see", " ", "above"}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"V", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9556543508732347`*^9, 3.955654677915978*^9}, {
   3.955654712936298*^9, 3.9556549022369337`*^9}, {3.955655069935*^9, 
   3.95565521808892*^9}, {3.955655307238906*^9, 3.955655330049427*^9}, {
   3.955655536345148*^9, 3.955655547399248*^9}, {3.956081731878828*^9, 
   3.956081908388214*^9}, {3.956081964524928*^9, 3.956082041190309*^9}, {
   3.956082182668988*^9, 3.9560821932785177`*^9}, {3.956082231485259*^9, 
   3.956082233056617*^9}, {3.956083374056983*^9, 3.9560833817276783`*^9}, {
   3.956129233839862*^9, 3.9561293252004642`*^9}, {3.956129359860523*^9, 
   3.956129384301366*^9}, {3.956129466693473*^9, 3.9561294682753973`*^9}, {
   3.956129685405751*^9, 3.9561297775031033`*^9}, {3.956129910423036*^9, 
   3.95612998671205*^9}, {3.956130088342931*^9, 3.956130088756749*^9}, {
   3.9561302935520763`*^9, 3.956130339864538*^9}, 3.9561304195318108`*^9, {
   3.956130545739962*^9, 3.956130545935999*^9}, {3.956131368630336*^9, 
   3.9561314417696943`*^9}, {3.956131485557637*^9, 3.956131502165077*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"fdc6aede-0eda-48a5-8914-46488909af39"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "GAUSS", " ", "ALGORITHM", " ", "for", " ", "2", "D", " ", "lattices"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Gaussalgorithm", "[", 
      RowBox[{"v1_", ",", "v2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "m", ",", "reduced"}], "}"}], ",", 
       RowBox[{
        RowBox[{"reduced", "=", "False"}], ";", 
        RowBox[{"(*", 
         RowBox[{"Initialize", " ", "flag"}], "*)"}], 
        RowBox[{"u", "=", 
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2"}], "}"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Store", " ", "input", " ", "vectors"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"Empty", " ", "loop", " ", 
          RowBox[{"(", 
           RowBox[{
           "does", " ", "nothing", " ", "but", " ", "is", " ", 
            "syntactically", " ", "valid"}], ")"}]}], "*)"}], 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "reduced"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"u", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", 
              RowBox[{"Norm", "[", 
               RowBox[{"u", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"u", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "=", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ".", 
                RowBox[{"u", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Update", " ", "v"}], "*)"}], 
           RowBox[{
            RowBox[{"u", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"m", "*", 
              RowBox[{"u", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Check", " ", "reduction", " ", "condition"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"u", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[GreaterEqual]", 
              RowBox[{"Norm", "[", 
               RowBox[{"u", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"reduced", "=", "True"}]}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "u"}]}], "  ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9561293497083387`*^9, 3.956129353210105*^9}, {
  3.956129394274057*^9, 3.956129412162801*^9}, {3.9561298144428167`*^9, 
  3.956129820181655*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"2f6c9412-27ec-415e-b11d-b2437bd45e97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"LLL", " ", 
    RowBox[{"ALGORITHM", ":", " ", 
     RowBox[{
      RowBox[{
      "Given", " ", "a", " ", "matrix", " ", "V", " ", "whose", " ", "ROWS", 
       " ", "form", " ", "a", " ", "basis"}], "\[IndentingNewLine]", "-", 
      RowBox[{
      "WE", " ", "TAKE", " ", "ROWS", " ", "BC", " ", "EASY", " ", "IN", " ", 
       "MATHEMATICA"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GramSchmidt", "[", "V_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "U", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"U", "=", "V"}], ";", "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "n"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<", "j"}], ",", 
             RowBox[{"i", "++"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"U", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ".", 
                 RowBox[{"U", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "/", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"U", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ".", 
                  RowBox[{"U", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"U", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "=", 
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "-", 
                RowBox[{
                 RowBox[{"M", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
                 RowBox[{"U", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], "]"}], 
           ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"U", ",", "M"}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LLLalgorithm", "[", "V_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "k", ",", "U", ",", "W", ",", "M"}], "}"}], ",", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "V", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"U", "=", "V"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"W", ",", "M"}], "}"}], "=", 
         RowBox[{"GramSchmidt", "[", "U", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"k", "\[LessEqual]", "n"}], ",", 
          RowBox[{"(*", 
           RowBox[{"Size", " ", "reduction"}], "*)"}], 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{"k", "-", "1"}]}], ",", 
             RowBox[{"j", "\[GreaterEqual]", "  ", "1"}], ",", 
             RowBox[{"j", "--"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"M", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}], ">", 
                 RowBox[{"1", "/", "2"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"U", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "=", 
                  RowBox[{
                   RowBox[{"U", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "k"}], "]"}], "]"}], "]"}], "*", 
                    RowBox[{"U", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"W", ",", "M"}], "}"}], "=", 
                  RowBox[{"GramSchmidt", "[", "U", "]"}]}], ";"}]}], "]"}], 
              ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Lov\[AAcute]sz", " ", "condition"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"W", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "]"}], "^", "2"}], 
               "\[GreaterEqual]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"3", "/", "4"}], "-", 
                  RowBox[{
                   RowBox[{"M", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "-", "1"}], ",", "k"}], "]"}], "]"}], "^", 
                   "2"}]}], ")"}], "*", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"W", "[", 
                   RowBox[{"[", 
                    RowBox[{"k", "-", "1"}], "]"}], "]"}], "]"}], "^", 
                 "2"}]}]}], ")"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Advance", " ", "if", " ", "yes"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"k", "=", 
              RowBox[{"k", "+", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Swap", " ", "and", " ", "recompute", " ", "If", " ", "not"}], 
              "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"U", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "-", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"U", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"U", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", 
                 RowBox[{"U", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "-", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"W", ",", "M"}], "}"}], "=", 
               RowBox[{"GramSchmidt", "[", "U", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"k", "=", 
               RowBox[{"Max", "[", 
                RowBox[{"2", ",", 
                 RowBox[{"k", "-", "1"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "U"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9560819146288147`*^9, 3.956081929285069*^9}, {
   3.956129346460423*^9, 3.9561293467231417`*^9}, {3.956129389191045*^9, 
   3.956129401836248*^9}, {3.9561298175519876`*^9, 3.956129830442162*^9}, {
   3.956130928399725*^9, 3.956131025901595*^9}, 3.9561310784739437`*^9, {
   3.956131200363057*^9, 3.9561312361845417`*^9}, 3.956131354723181*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"be9c64eb-d61b-4b62-afea-2aefa2e6aebf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "EXAMPLES", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Knuth", " ", "pg", " ", "103"}], "-", "104", 
     "\[IndentingNewLine]", "-", "N"}], "=", "2"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", "10", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "3141592621"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Reduced2\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"ShortvectorGauss", "[", 
    RowBox[{"a", ",", "m"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Reduced2LLL\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"ShortvectorLLL", "[", 
    RowBox[{"a", ",", "m", ",", "2"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Knuth", " ", "pg", " ", "103"}], "-", "104", 
      "\[IndentingNewLine]", "-", "N"}], "=", "3"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"10", "^", 
      RowBox[{"(", "10", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "3141592621"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Reduced3LLL\>\"", "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"ShortvectorLLL", "[", 
    RowBox[{"a", ",", "m", ",", "n"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9560820463707647`*^9, 3.956082151544362*^9}, {
  3.9560831116920757`*^9, 3.9560831233062897`*^9}, {3.956083247777355*^9, 
  3.956083303737125*^9}, {3.956083403320166*^9, 3.95608341841463*^9}, {
  3.956129427093779*^9, 3.9561294456593647`*^9}, {3.9561294906008863`*^9, 
  3.956129502196452*^9}, {3.956129589197538*^9, 3.956129602134481*^9}, {
  3.956129827416205*^9, 3.956129865185123*^9}, {3.956130139981922*^9, 
  3.956130204901168*^9}, {3.9561302446760178`*^9, 3.956130265163156*^9}, {
  3.956130370490078*^9, 3.956130398628186*^9}, {3.9561304558521767`*^9, 
  3.956130456296977*^9}, {3.95613049610747*^9, 3.956130516409842*^9}, {
  3.956130583148539*^9, 3.956130600310113*^9}, {3.956131450176592*^9, 
  3.956131454503449*^9}, {3.956131507685862*^9, 3.956131571168323*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"2e09b38c-b7b9-4500-9848-a5ec9d44ed31"],

Cell[BoxData["\<\"Reduced2\"\>"], "Print",
 CellChangeTimes->{{3.9560832955105553`*^9, 3.956083323422304*^9}, 
   3.956083389229431*^9, 3.956083419934492*^9, 3.9561294849354553`*^9, 
   3.9561296039167852`*^9, 3.956130019376586*^9, {3.956130179012005*^9, 
   3.956130205440205*^9}, 3.956130266865569*^9, 3.95613039941714*^9, {
   3.9561304487412767`*^9, 3.9561304576500463`*^9}, 3.9561304999162273`*^9, 
   3.956130600942976*^9, 3.956131514380848*^9, 3.956131573243952*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"8dcb1d67-3bd5-4e17-8c14-a7985dfe31d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"67654", ",", "226"}], "}"}]], "Output",
 CellChangeTimes->{{3.956083295511985*^9, 3.956083323423472*^9}, 
   3.956083389230606*^9, 3.956083419935865*^9, 3.95612948493705*^9, 
   3.956129603918293*^9, 3.9561300193758383`*^9, {3.956130179013361*^9, 
   3.9561302054416723`*^9}, 3.956130266866761*^9, 3.956130399418692*^9, {
   3.9561304487424803`*^9, 3.9561304576513777`*^9}, 3.956130499917673*^9, 
   3.956130600944366*^9, 3.9561315143822813`*^9, 3.95613157324516*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"edc7909a-38e7-4fa8-aa49-34cec08eabe1"],

Cell[BoxData["\<\"Reduced2LLL\"\>"], "Print",
 CellChangeTimes->{{3.9560832955105553`*^9, 3.956083323422304*^9}, 
   3.956083389229431*^9, 3.956083419934492*^9, 3.9561294849354553`*^9, 
   3.9561296039167852`*^9, 3.956130019376586*^9, {3.956130179012005*^9, 
   3.956130205440205*^9}, 3.956130266865569*^9, 3.95613039941714*^9, {
   3.9561304487412767`*^9, 3.9561304576500463`*^9}, 3.9561304999162273`*^9, 
   3.956130600942976*^9, 3.956131514380848*^9, 3.956131573245995*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"b5c084c8-d687-426f-a22a-0562c50d0a6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"67654", ",", "226"}], "}"}]], "Output",
 CellChangeTimes->{{3.956083295511985*^9, 3.956083323423472*^9}, 
   3.956083389230606*^9, 3.956083419935865*^9, 3.95612948493705*^9, 
   3.956129603918293*^9, 3.9561300193758383`*^9, {3.956130179013361*^9, 
   3.9561302054416723`*^9}, 3.956130266866761*^9, 3.956130399418692*^9, {
   3.9561304487424803`*^9, 3.9561304576513777`*^9}, 3.956130499917673*^9, 
   3.956130600944366*^9, 3.9561315143822813`*^9, 3.956131573247168*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"2b2ad544-d710-44f6-8dc4-1a017822fe56"],

Cell[BoxData["\<\"Reduced3LLL\"\>"], "Print",
 CellChangeTimes->{{3.9560832955105553`*^9, 3.956083323422304*^9}, 
   3.956083389229431*^9, 3.956083419934492*^9, 3.9561294849354553`*^9, 
   3.9561296039167852`*^9, 3.956130019376586*^9, {3.956130179012005*^9, 
   3.956130205440205*^9}, 3.956130266865569*^9, 3.95613039941714*^9, {
   3.9561304487412767`*^9, 3.9561304576500463`*^9}, 3.9561304999162273`*^9, 
   3.956130600942976*^9, 3.956131514380848*^9, 3.956131573247942*^9},
 CellLabel->
  "During evaluation of \
In[56]:=",ExpressionUUID->"c2754da7-2e2a-4766-b848-a201f93c79b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "227"}], ",", 
   RowBox[{"-", "983"}], ",", 
   RowBox[{"-", "130"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.956083295511985*^9, 3.956083323423472*^9}, 
   3.956083389230606*^9, 3.956083419935865*^9, 3.95612948493705*^9, 
   3.956129603918293*^9, 3.9561300193758383`*^9, {3.956130179013361*^9, 
   3.9561302054416723`*^9}, 3.956130266866761*^9, 3.956130399418692*^9, {
   3.9561304487424803`*^9, 3.9561304576513777`*^9}, 3.956130499917673*^9, 
   3.956130600944366*^9, 3.9561315143822813`*^9, 3.9561315732490597`*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"b1512873-ffd0-4854-9406-550d09fa9c4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MORE", " ", "EXAMPLES"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"L", "'"}], "ECUYER"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"2", "^", 
      RowBox[{"(", "64", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", "3202034522624059733"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ShortvectorGauss", "[", 
    RowBox[{"a", ",", "m"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"ShortvectorLLL", "[", 
    RowBox[{"a", ",", "m", ",", "6"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9564293150464087`*^9, 3.956429409466309*^9}, {
  3.956429440127866*^9, 3.956429471336522*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"6643a427-83a1-4d7d-8268-5e2c40b92e68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3221262249", ",", "193626875"}], "}"}]], "Output",
 CellChangeTimes->{{3.9564294104283857`*^9, 3.956429424136874*^9}, {
  3.956429458716515*^9, 3.956429471869104*^9}},
 CellLabel->"Out[23]=",ExpressionUUID->"db85fa98-64b0-4261-a5ba-4c66dd41965d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"791", ",", 
   RowBox[{"-", "39"}], ",", 
   RowBox[{"-", "188"}], ",", "695", ",", 
   RowBox[{"-", "846"}], ",", "255"}], "}"}]], "Output",
 CellChangeTimes->{{3.9564294104283857`*^9, 3.956429424136874*^9}, {
  3.956429458716515*^9, 3.956429472075795*^9}},
 CellLabel->"Out[25]=",ExpressionUUID->"aaeae402-524d-44b3-ba0d-790826a49bc2"]
}, Open  ]]
},
WindowSize->{808, 686},
WindowMargins->{{Automatic, 30}, {Automatic, 13}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10434, 258, 1312, "Input",ExpressionUUID->"fdc6aede-0eda-48a5-8914-46488909af39"],
Cell[10995, 280, 3912, 99, 409, "Input",ExpressionUUID->"2f6c9412-27ec-415e-b11d-b2437bd45e97"],
Cell[14910, 381, 8318, 205, 724, "Input",ExpressionUUID->"be9c64eb-d61b-4b62-afea-2aefa2e6aebf"],
Cell[CellGroupData[{
Cell[23253, 590, 2435, 54, 388, "Input",ExpressionUUID->"2e09b38c-b7b9-4500-9848-a5ec9d44ed31"],
Cell[25691, 646, 578, 9, 24, "Print",ExpressionUUID->"8dcb1d67-3bd5-4e17-8c14-a7985dfe31d8"],
Cell[26272, 657, 586, 9, 34, "Output",ExpressionUUID->"edc7909a-38e7-4fa8-aa49-34cec08eabe1"],
Cell[26861, 668, 581, 9, 24, "Print",ExpressionUUID->"b5c084c8-d687-426f-a22a-0562c50d0a6d"],
Cell[27445, 679, 587, 9, 34, "Output",ExpressionUUID->"2b2ad544-d710-44f6-8dc4-1a017822fe56"],
Cell[28035, 690, 581, 9, 24, "Print",ExpressionUUID->"c2754da7-2e2a-4766-b848-a201f93c79b2"],
Cell[28619, 701, 656, 12, 34, "Output",ExpressionUUID->"b1512873-ffd0-4854-9406-550d09fa9c4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29312, 718, 944, 23, 199, "Input",ExpressionUUID->"6643a427-83a1-4d7d-8268-5e2c40b92e68"],
Cell[30259, 743, 286, 5, 34, "Output",ExpressionUUID->"db85fa98-64b0-4261-a5ba-4c66dd41965d"],
Cell[30548, 750, 377, 8, 34, "Output",ExpressionUUID->"aaeae402-524d-44b3-ba0d-790826a49bc2"]
}, Open  ]]
}
]
*)

